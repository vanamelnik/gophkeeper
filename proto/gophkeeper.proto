/*
    GophKeeper protobuf definitions
*/
syntax="proto3";

option go_package="./proto";

package proto;

service gophkeeper {
    rpc SignUp(SignInData) returns (UserAuth);
    rpc LogIn(SignInData) returns (UserAuth);
    rpc GetAccessToken(RefreshToken) returns (AccessToken);

    rpc StorePassword(StorePasswordRequest) returns(ItemID);
    rpc StoreBlob(StoreBlobRequest) returns (ItemID);
    rpc StoreText(StoreTextRequest) returns (ItemID);
    rpc StoreCard(StoreCardRequest) returns (ItemID);

    rpc GetData(AccessToken) returns (Data);
}

message Password {
    ItemID item_id = 1;
    repeated MetaData meta = 2;

    string password = 3;
}

message Blob {
    ItemID item_id = 1;
    repeated MetaData meta = 2;

    bytes data = 3;
}

message Text {
    ItemID item_id = 1;
    repeated MetaData meta = 2;

    string text = 3;
}

message Card {
    ItemID item_id = 1;
    repeated MetaData meta = 2;

    string number = 3;
    string name = 4;
    string date = 5;
    uint32 cvc = 6;
}

message Data {
    repeated Password passwords = 1;
    repeated Blob blobs = 2;
    repeated Text texts = 3;
    repeated Card cards = 4;
}

message MetaData {
    string key = 1;
    string value = 2;
}

message ItemID {
    string item_id = 1;
}

message UserAuth {
    AccessToken access_token = 1;
    RefreshToken  refresh_token = 2;
}

message AccessToken {
    string access_token = 1;
}

message RefreshToken {
    string refresh_token = 1;
}

message SignInData {
    string user_name = 1;
    string user_password = 2;
}

message StorePasswordRequest {
    AccessToken access_token = 1;
    Password password = 2;
}

message StoreBlobRequest {
    AccessToken access_token = 1;
    Blob blob = 2;
}

message StoreTextRequest {
    AccessToken access_token = 1;
    Text text = 2;
}

message StoreCardRequest {
    AccessToken access_token = 1;
    Card card = 2;
}
